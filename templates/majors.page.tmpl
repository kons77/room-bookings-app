{{template "base" .}} 


{{define "content"}}

<div class="container">
    <div class="row">
        <div class="col">
            <img src="/static/images/marjors-suite.png" class="img-fluid img-thumbnail mx-auto d-block room-image"  alt="General's Quarters">
        </div>
    </div>
    <div class="row">
        <div class="col">
            <h1 class="text-center mt-4">Major's Suite</h1>
            <p> 
                The Major's Suite beckons like a sonnet, its melody steeped in both valor and quiet longing. Soft light spills through the lace-curtained windows, casting ethereal patterns upon walls painted in hues of twilight. The faint scent of aged leather and dried lavender lingers here, weaving an atmosphere that is both comforting and otherworldly. A writing desk sits poised in the corner, as though waiting for a hand to transcribe musings born of still nights.
            </p>
            <p>
                The bed, clad in silken drapery of deep emerald, promises a rest fit for those who have known the weight of the world upon their shoulders. This is a chamber of introspection and repose, where the echoes of a soldier's heart find solace, and the weary are gently reminded that even the boldest spirits deserve peace.
            </p>
        </div>
    </div>

    <div class="row">
        <div class="col text-center">
            <a id="check-availability-button" href="#!" class="btn btn-success">Check Availability</a>
        </div>
    </div>
</div>

{{end}}

{{define "js"}}
<script>
    document.getElementById("check-availability-button").addEventListener("click", function(){            
    let html = `
    <form id="check-availability-form" action="" method="post" novalidate class="needs-validation">
        <div class="row">
            <div class="col">
                <div class="row" id="reservation-dates-modal">
                    <div class="col">
                        <input disabled required class="form-control" type="text" name="start" id="start" placeholder="Arrival">
                    </div>
                    <div class="col">
                        <input disabled required class="form-control" type="text" name="end" id="end" placeholder="Departure">
                    </div>
                </div>        
            </div>
        </div>
    </form>
    `
    
    attention.custom({
        msg: html, 
        title: "Choose your dates", 

        willOpen: () => {
            const elem = document.getElementById("reservation-dates-modal");
            const rp = new DateRangePicker(elem, {
                format: 'yyyy-mm-dd',
                showOnFocus: true,
                orientation: "auto top",
                minDate: new Date(),
            })
        },
        
        didOpen: () => {
            document.getElementById("start").removeAttribute("disabled");
            document.getElementById("end").removeAttribute("disabled");
        },

        callback: function(result) {
            console.log("called");

            let form = document.getElementById("check-availability-form");
            let formData = new FormData(form);
            formData.append("csrf_token", "{{.CSRFToken}}")
            formData.append("room_id", "2")

            fetch("/search-availability-json", {
                method: "post", 
                body: formData,                    
            })
                .then(response => response.json())
                .then(data => {
                    if (data.ok) {
                        attention.custom({
                            icon: 'success',
                            showConfirmButton: false,
                            msg: '<p>Rooms is available<p>' 
                                + '<p><a href="/book-room?id='
                                + data.room_id 
                                + '&s=' + data.start_date
                                + '&e=' + data.end_date
                                + '" class="btn btn-primary">'
                                + 'Book Now!</a><p>',
                        })
                    } else {
                        attention.error({
                            msg: "No avalability",
                        });
                        
                    }
                })
        }
    });
})
</script>
{{end}}